# Ingress-Nginx values for HA setup (3+ masters)
# Master preferred, worker fallback strategy
# Note: Toleration is included by default. If master_taint_enabled: false, it will be overridden via --set

controller:
  replicaCount: 2
  
  # Master preferred, worker fallback
  # Toleration allows scheduling on tainted masters (will be removed if master_taint_enabled: false)
  tolerations:
    - key: "node-role.kubernetes.io/master"
      operator: "Equal"
      value: "system"
      effect: "NoSchedule"
  
  affinity:
    nodeAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          preference:
            matchExpressions:
              - key: node-role.kubernetes.io/master
                operator: Exists
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - ingress-nginx
              - key: app.kubernetes.io/component
                operator: In
                values:
                  - controller
          topologyKey: "kubernetes.io/hostname"


